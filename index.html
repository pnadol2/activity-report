<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ© - ØªÙ‚Ø±ÙŠØ±</title>
<meta name="description" content="Ù‚Ø§Ù„Ø¨ ØªÙ‚Ø±ÙŠØ± Ù†Ø´Ø§Ø· (RTL) Ù…Ø¹ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆWord">
<style>
:root{
  --bg:#f7f7f9; --fg:#111; --muted:#6b7280; --card:#fff; --border:#e5e7eb;
  --accent:#0ea5e9; --print-fg:#000;
  --font:"Tajawal","Cairo",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Arabic",Arial,sans-serif;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:var(--font)}
.header{
  background:linear-gradient(90deg,#0f766e,#198754);
  color:#fff; padding:16px 12px 10px; border-bottom:4px solid rgba(255,255,255,.15);
}
.header .top{display:flex;justify-content:space-between;align-items:center;gap:12px}
.header .badge{background:#fff;color:#0f172a;padding:8px 16px;border-radius:999px;font-weight:800}
.header .logo-wrap{display:flex;align-items:center;gap:10px}
.header img.logo{height:40px;object-fit:contain}
.header .logo-fallback{font-weight:800;opacity:.95}
.header .icons{display:flex;gap:12px;align-items:center;margin:12px 0 2px}
.header .ic{width:44px;height:44px;border-radius:50%;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:20px}
.container{max-width:1100px;margin:16px auto 24px;padding:0 14px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;margin:12px 0}
.card h2{margin:.25rem 0 1rem}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
label{display:flex;flex-direction:column;gap:6px;font-weight:600}
input,textarea{padding:10px;border:1px solid var(--border);border-radius:10px;background:#fff;font:inherit}
textarea{resize:vertical}
.actions{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 0}
button,.btn{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
button.ghost{background:#fff;color:var(--fg);border:1px solid var(--border)}
.small{font-size:.92rem;color:var(--muted)}
.flex{display:flex;gap:8px;align-items:center}
.flex input[type="text"]{flex:1}

/* Evidence (exactly 4 slots) */
.evd-4{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.slot{border:1px dashed var(--border);border-radius:12px;background:#fff;overflow:hidden;position:relative;min-height:160px}
.slot img{width:100%;height:160px;object-fit:cover;display:block}
.slot .cap{padding:6px 8px;font-size:.9rem;border-top:1px solid var(--border)}
.slot .remove{position:absolute;top:6px;left:6px;background:#fff;color:#b91c1c;border:1px solid #fecaca;border-radius:8px;padding:4px 8px;cursor:pointer}

/* Print area */
.print-area{display:none}
.report{padding:18mm 16mm;color:var(--print-fg)}
.report .r-head{text-align:center;margin-bottom:8mm}
.r-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6mm}
.r-top .r-logos{display:flex;gap:12px;align-items:center}
.r-top img.logo{height:34px}
.r-top .v2030{font-weight:800;color:#0f766e}
.report h1{margin:0}
.meta{color:#374151;margin:2mm 0 6mm}
.info-table{width:100%;border-collapse:collapse;margin:8px 0 12px}
.info-table th,.info-table td{border:1px solid #999;padding:6px 8px;text-align:right;vertical-align:top}
.para{min-height:18px;border:1px solid #bbb;padding:8px;border-radius:6px;margin:4px 0 10px;white-space:pre-wrap}
.ev4-print{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.ev4-print .box{border:1px solid #bbb;border-radius:6px;overflow:hidden}
.ev4-print img{width:100%;height:180px;object-fit:cover;display:block}
.sign-table{width:100%;border-collapse:collapse;margin-top:8px}
.sign-table th,.sign-table td{border:1px solid #999;padding:6px 8px;text-align:right}
.footer-line{display:flex;justify-content:space-between;margin-top:10mm;font-size:.95rem;color:#111}

/* Print rules */
@media print{
  @page { size: A4; margin: 12mm }
  .no-print{display:none !important}
  body{background:#fff}
  .print-area{display:block}
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="header no-print">
  <div class="top">
    <div class="badge">Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ©</div>
    <div class="logo-wrap">
      <img id="moeLogo" class="logo" alt="Ø´Ø¹Ø§Ø± ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…" />
      <div class="logo-fallback" id="moeLogoFallback">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
      <label class="btn ghost" style="margin-inline-start:8px">Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±
        <input id="logoInput" type="file" accept="image/*" style="display:none">
      </label>
    </div>
  </div>
  <div class="icons">
    <div class="ic">ğŸ’»</div><div class="ic">ğŸ¤</div><div class="ic">âš—ï¸</div><div class="ic">ğŸƒ</div><div class="ic">ğŸ¨</div>
  </div>
  <div class="container">
    <h1 id="docTitle" contenteditable="true" spellcheck="false" style="margin:8px 0 0">ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h1>
    <p id="docSub" contenteditable="true" class="small" style="margin:6px 0 0">Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©</p>
    <div class="actions">
      <button id="btnPreview">Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
      <button id="btnWord">ØªØµØ¯ÙŠØ± Word</button>
      <label class="btn ghost">
        ÙØªØ­ Ø¨ÙŠØ§Ù†Ø§Øª JSON
        <input id="openJson" type="file" accept="application/json" style="display:none">
      </label>
      <a id="btnSave" class="btn" href="#" download="report.json">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</a>
    </div>
  </div>
</header>

<main class="container no-print">
  <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
  <section class="card">
    <h2 contenteditable="true" id="titleBasic">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
    <div class="grid">
      <label>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…<input id="eduDir" placeholder="ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©"></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<input id="school" placeholder="..."></label>
      <label>Ø§Ù„Ù‚Ø³Ù…<input id="dept" placeholder="Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ / Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ ..."></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ù€Ø©<input id="teacher"></label>
      <label>Ø§Ù„ØªØ®ØµØµ<input id="major"></label>
      <label>Ø§Ù„ØµÙ<input id="class"></label>
      <label>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ<input id="term"></label>
      <label>Ø§Ù„ÙŠÙˆÙ…<input id="day" placeholder="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"></label>
      <label>Ø§Ù„ØªØ§Ø±ÙŠØ®<input id="date_g" type="date"></label>
      <label>Ø§Ù„Ø­ØµØ©<input id="period" placeholder="Ø§Ù„Ø«Ø§Ù†ÙŠØ©"></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬<input id="program"></label>
      <label>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°<input id="place"></label>
      <label>Ø§Ù„Ø­Ø¶ÙˆØ±<input id="attendance" placeholder="34"></label>
      <label>Ø§Ù„ØºÙŠØ§Ø¨<input id="absence" placeholder="1"></label>
      <label>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©<input id="audience"></label>
      <label>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„/Ù€Ø©<input id="owner"></label>
    </div>
  </section>

  <!-- Ø§Ù„Ø£Ù‡Ø¯Ø§Ù -->
  <section class="card">
    <h2 id="titleGoals" contenteditable="true">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <textarea id="goals" rows="3" placeholder="- ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø©
- ØªØ¹Ø²ÙŠØ² Ø§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§Ù…"></textarea>
  </section>

  <!-- Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ -->
  <section class="card">
    <h2 id="titleOutcomes" contenteditable="true">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <textarea id="outcomes" rows="3" placeholder="- ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ
- ØºØ±Ø³ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø·Ø§Ø¡ ÙˆØªÙ†Ù…ÙŠØ© Ø±ÙˆØ­ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©"></textarea>
  </section>

  <!-- Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (Ù¤ ØµÙˆØ± Ø¨Ø§Ù„Ø¶Ø¨Ø·) -->
  <section class="card">
    <h2 id="titleEvidence" contenteditable="true">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (Ù¤ ØµÙˆØ±)</h2>
    <div class="small">Ø§Ø±ÙØ¹ Ù¤ ØµÙˆØ± (Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø£ÙŠ ØµÙˆØ±Ø© Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ù†Ø¯ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ø¯Ø¯).</div>
    <div class="actions">
      <label class="btn">Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± (Ø­ØªÙ‰ 4)
        <input id="evImages" type="file" accept="image/*" multiple style="display:none">
      </label>
    </div>
    <div id="slots" class="evd-4" style="margin-top:10px">
      <div class="slot" data-i="0"><div class="cap">Ø§Ù„ØµÙˆØ±Ø© 1</div></div>
      <div class="slot" data-i="1"><div class="cap">Ø§Ù„ØµÙˆØ±Ø© 2</div></div>
      <div class="slot" data-i="2"><div class="cap">Ø§Ù„ØµÙˆØ±Ø© 3</div></div>
      <div class="slot" data-i="3"><div class="cap">Ø§Ù„ØµÙˆØ±Ø© 4</div></div>
    </div>
  </section>

  <!-- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª -->
  <section class="card">
    <h2 id="titleSign" contenteditable="true">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</h2>
    <div class="grid">
      <label>Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<input id="signPrincipal" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±/Ø©"></label>
      <label>Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·<input id="signLeader" placeholder="Ø§Ø³Ù… Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·"></label>
    </div>
  </section>
</main>

<!-- PRINT -->
<section id="printArea" class="print-area">
  <div class="report">
    <div class="r-top">
      <div class="r-logos">
        <img id="pMoeLogo" class="logo" alt="Ø´Ø¹Ø§Ø± ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
        <span class="v2030">Ø±Ø¤ÙŠØ© 2030</span>
      </div>
      <div></div>
    </div>

    <h1 id="pDocTitle">ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h1>
    <div class="meta" id="pSub">Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©</div>
    <div class="meta"><span id="pEduDir"></span> â€” <span id="pSchool"></span> â€” <span id="pDept"></span></div>

    <table class="info-table">
      <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ù€Ø©</th><td id="pTeacher"></td><th>Ø§Ù„ØªØ®ØµØµ</th><td id="pMajor"></td></tr>
      <tr><th>Ø§Ù„ØµÙ</th><td id="pClass"></td><th>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</th><td id="pTerm"></td></tr>
      <tr><th>Ø§Ù„ÙŠÙˆÙ…</th><td id="pDay"></td><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><td id="pDateG"></td></tr>
      <tr><th>Ø§Ù„Ø­ØµØ©</th><td id="pPeriod"></td><th>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°</th><td id="pPlace"></td></tr>
      <tr><th>Ø§Ù„Ø­Ø¶ÙˆØ±</th><td id="pAttendance"></td><th>Ø§Ù„ØºÙŠØ§Ø¨</th><td id="pAbsence"></td></tr>
      <tr><th>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</th><td id="pAudience"></td><th>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„/Ù€Ø©</th><td id="pOwner"></td></tr>
      <tr><th>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th><td id="pProgram" colspan="3"></td></tr>
    </table>

    <h2 id="pTitleGoals">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <div id="pGoals" class="para"></div>

    <h2 id="pTitleOutcomes">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <div id="pOutcomes" class="para"></div>

    <h2 id="pTitleEvidence">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</h2>
    <div id="pEvGrid" class="ev4-print">
      <div class="box"><img id="pImg0" alt=""></div>
      <div class="box"><img id="pImg1" alt=""></div>
      <div class="box"><img id="pImg2" alt=""></div>
      <div class="box"><img id="pImg3" alt=""></div>
    </div>

    <h2 id="pTitleSign">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</h2>
    <table class="sign-table">
      <tr><th>Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th><td id="pSignPrincipal"></td></tr>
      <tr><th>Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·</th><td id="pSignLeader"></td></tr>
    </table>

    <div class="footer-line">
      <div>Ø£ÙØ¹Ø¯ Ø¨ÙˆØ§Ø³Ø·Ø©: <span id="pOwner2"></span></div>
      <div>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: <span id="pPrintDate"></span></div>
    </div>
  </div>
</section>

<script>
(function(){
  const $ = id => document.getElementById(id);

  // Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ²Ø§Ø±Ø©: Ø±ÙØ¹ ØµÙˆØ±Ø© â†’ ØªØ¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø©
  const logoImg = $("moeLogo"), logoFallback = $("moeLogoFallback"), pLogo = $("pMoeLogo");
  $("logoInput").addEventListener("change", ev=>{
    const f = ev.target.files[0]; if(!f) return;
    const r = new FileReader();
    r.onload = ()=>{ logoImg.src = r.result; pLogo.src = r.result; logoFallback.style.display="none"; };
    r.readAsDataURL(f);
  });

  // ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…
  (function(){ const d = new Date(); $("date_g").value = d.toISOString().slice(0,10); })();

  // ØªØ¹Ø¨Ø¦Ø©/Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„
  const F = ["eduDir","school","dept","teacher","major","class","term","day","date_g","period","program","place","attendance","absence","audience","owner","signPrincipal","signLeader"];
  function get(id){ return $(id).value || ""; }
  function set(id,val){ const el=$(id); if(el) el.textContent = val||""; }

  // Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯: Ù¤ ØµÙˆØ± Ø¨Ø§Ù„Ø¶Ø¨Ø·
  const slots = Array.from(document.querySelectorAll(".slot"));
  const imgs = [null,null,null,null]; // dataURL
  function putImageInSlot(url, i){
    const s = slots[i]; s.innerHTML = "";
    const img = document.createElement("img"); img.src = url; s.appendChild(img);
    const cap = document.createElement("div"); cap.className="cap"; cap.contentEditable=true; cap.textContent="ÙˆØµÙ Ø§Ù„Ø´Ø§Ù‡Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)";
    cap.oninput = ()=> s.dataset.cap = cap.textContent;
    s.appendChild(cap);
    const rm = document.createElement("button"); rm.className="remove"; rm.textContent="Ø­Ø°Ù";
    rm.onclick = ()=>{ imgs[i]=null; s.innerHTML='<div class="cap">Ø§Ù„ØµÙˆØ±Ø© '+(i+1)+'</div>'; };
    s.appendChild(rm);
    imgs[i]=url;
  }
  $("evImages").addEventListener("change", e=>{
    const files = Array.from(e.target.files||[]);
    // Ø®Ø° Ø£ÙˆÙ„ 4 ÙÙ‚Ø·
    files.slice(0,4).forEach((f,idx)=>{
      const r = new FileReader();
      r.onload = ()=> putImageInSlot(r.result, idx);
      r.readAsDataURL(f);
    });
    e.target.value="";
  });

  // Ø­ÙØ¸ JSON
  $("btnSave").onclick = (e)=>{
    const data = {};
    F.forEach(f=> data[f]=get(f));
    data.headings = {
      docTitle: $("docTitle").textContent,
      docSub: $("docSub").textContent,
      goals: $("titleGoals").textContent,
      outcomes: $("titleOutcomes").textContent,
      evidence: $("titleEvidence").textContent,
      sign: $("titleSign").textContent
    };
    data.evidence4 = imgs.map((u,i)=> ({url:u, cap: (slots[i] && slots[i].dataset.cap)||""}));
    const blob = new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
    const url = URL.createObjectURL(blob); e.currentTarget.href=url; e.currentTarget.download="report.json";
    setTimeout(()=>URL.revokeObjectURL(url),4000);
  };

  // ÙØªØ­ JSON
  $("openJson").addEventListener("change", ev=>{
    const f=ev.target.files[0]; if(!f) return;
    const r=new FileReader();
    r.onload=()=>{
      try{
        const d=JSON.parse(r.result);
        F.forEach(k=> { if(d[k]!==undefined) $(k).value=d[k]; });
        if(d.headings){
          $("docTitle").textContent=d.headings.docTitle||$("docTitle").textContent;
          $("docSub").textContent=d.headings.docSub||$("docSub").textContent;
          $("titleGoals").textContent=d.headings.goals||$("titleGoals").textContent;
          $("titleOutcomes").textContent=d.headings.outcomes||$("titleOutcomes").textContent;
          $("titleEvidence").textContent=d.headings.evidence||$("titleEvidence").textContent;
          $("titleSign").textContent=d.headings.sign||$("titleSign").textContent;
        }
        if(Array.isArray(d.evidence4)){
          d.evidence4.slice(0,4).forEach((it,idx)=>{ if(it && it.url){ putImageInSlot(it.url, idx); if(slots[idx]) slots[idx].dataset.cap=it.cap||""; } });
        }
      }catch(e){ alert("Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­"); }
    };
    r.readAsText(f);
  });

  // ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
  function fillPrint(){
    set("pDocTitle", $("docTitle").textContent);
    set("pSub", $("docSub").textContent);
    set("pEduDir", get("eduDir")); set("pSchool", get("school")); set("pDept", get("dept"));
    set("pTeacher", get("teacher")); set("pMajor", get("major"));
    set("pClass", get("class")); set("pTerm", get("term"));
    set("pDay", get("day")); set("pDateG", get("date_g"));
    set("pPeriod", get("period")); set("pPlace", get("place"));
    set("pAttendance", get("attendance")); set("pAbsence", get("absence"));
    set("pAudience", get("audience")); set("pOwner", get("owner")); set("pOwner2", get("owner"));
    set("pProgram", get("program"));
    set("pTitleGoals", $("titleGoals").textContent);
    set("pTitleOutcomes", $("titleOutcomes").textContent);
    set("pTitleEvidence", $("titleEvidence").textContent);
    set("pTitleSign", $("titleSign").textContent);
    $("pPrintDate").textContent = new Date().toLocaleDateString("ar-SA");

    // ØµÙˆØ± Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„Ø£Ø±Ø¨Ø¹Ø©
    [0,1,2,3].forEach(i=>{
      const u = imgs[i];
      const cap = (slots[i] && slots[i].dataset.cap) || "";
      const imgEl = $("pImg"+i);
      if(u){ imgEl.src = u; imgEl.alt = cap; imgEl.parentElement.style.display="block"; }
      else { imgEl.src=""; imgEl.alt=""; imgEl.parentElement.style.display="block"; } // ÙŠØ¨Ù‚Ù‰ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ù…ÙˆØ¬ÙˆØ¯
    });
    // Ø´Ø¹Ø§Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ù‡
    if(logoImg.src){ $("pMoeLogo").src = logoImg.src; }
  }

  $("btnPreview").onclick = ()=>{ fillPrint(); window.print(); };
  $("btnWord").onclick = ()=>{
    fillPrint();
    const content = document.querySelector("#printArea").innerHTML;
    const html = `<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="utf-8"></head><body>${content}</body></html>`;
    const blob = new Blob([html], {type:"application/msword"});
    const url = URL.createObjectURL(blob); const a=document.createElement("a");
    a.href=url; a.download="ØªÙ‚Ø±ÙŠØ±-Ù†Ø´Ø§Ø·.doc"; a.click();
    setTimeout(()=>URL.revokeObjectURL(url),4000);
  };
})();
</script>
</body>
</html>
