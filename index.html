<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ© - ØªÙ‚Ø±ÙŠØ±</title>
<meta name="description" content="Ù‚Ø§Ù„Ø¨ ØªÙ‚Ø±ÙŠØ± Ù†Ø´Ø§Ø· (RTL) Ù…Ø¹ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆWord">
<style>
:root{
  --bg:#f7f7f9; --fg:#111; --muted:#6b7280; --card:#fff; --border:#e5e7eb;
  --accent:#0ea5e9; --print-fg:#000;
  --font: "Tajawal","Cairo",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Arabic",Arial,sans-serif;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:var(--font)}
/* Header */
.header{
  background:linear-gradient(90deg,#0f766e,#198754);
  color:#fff; padding:16px 12px 10px;
  border-bottom:4px solid rgba(255,255,255,.15);
}
.header .top{display:flex;justify-content:space-between;align-items:center;gap:12px}
.header .badge{background:#fff;color:#0f172a;padding:8px 16px;border-radius:999px;font-weight:800}
.header .logo{font-weight:800;opacity:.95}
.header .icons{display:flex;gap:12px;align-items:center;margin:12px 0 2px}
.header .ic{width:44px;height:44px;border-radius:50%;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:20px}
.container{max-width:1100px;margin:16px auto 24px;padding:0 14px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;margin:12px 0}
.card h2{margin:.25rem 0 1rem}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
label{display:flex;flex-direction:column;gap:6px;font-weight:600}
input,textarea{padding:10px;border:1px solid var(--border);border-radius:10px;background:#fff;font:inherit}
textarea{resize:vertical}
.actions{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 0}
button,.btn{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
button.ghost{background:#fff;color:var(--fg);border:1px solid var(--border)}
.small{font-size:.92rem;color:var(--muted)}
/* Evidence */
.evd-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px}
.evd-item{border:1px dashed var(--border);border-radius:10px;overflow:hidden;background:#fff}
.evd-item img{width:100%;height:100px;object-fit:cover;display:block}
.evd-item .cap{padding:6px 8px;font-size:.9rem}
.flex{display:flex;gap:8px;align-items:center}
.flex input[type="text"]{flex:1}

/* Print area */
.print-area{display:none}
.report{padding:18mm 16mm;color:var(--print-fg)}
.report .r-head{text-align:center;margin-bottom:8mm}
.r-logos{display:flex;justify-content:space-between;color:#0f766e;font-weight:800}
.report h1{margin:6px 0 4px}
.meta{color:#374151;margin:0 0 8px}
.info-table{width:100%;border-collapse:collapse;margin:8px 0 12px}
.info-table th,.info-table td{border:1px solid #999;padding:6px 8px;text-align:right;vertical-align:top}
.para{min-height:18px;border:1px solid #bbb;padding:8px;border-radius:6px;margin:4px 0 10px;white-space:pre-wrap}
.evidence-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;padding:0;list-style:none}
.evidence-grid li{border:1px solid #bbb;border-radius:6px;padding:6px}
.sign-table{width:100%;border-collapse:collapse;margin-top:8px}
.sign-table th,.sign-table td{border:1px solid #999;padding:6px 8px;text-align:right}
.footer-line{display:flex;justify-content:space-between;margin-top:10mm;font-size:.95rem;color:#111}
.hidden{display:none !important}

/* Print rules */
@media print{
  @page { size: A4; margin: 12mm }
  .no-print{display:none !important}
  body{background:#fff}
  .print-area{display:block}
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="header no-print">
  <div class="top">
    <div class="badge">Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ©</div>
    <div class="logo">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
  </div>
  <div class="icons">
    <div class="ic">ğŸ’»</div><div class="ic">ğŸ¤</div><div class="ic">âš—ï¸</div><div class="ic">ğŸƒ</div><div class="ic">ğŸ¨</div>
  </div>
  <div class="container">
    <h1 id="docTitle" contenteditable="true" spellcheck="false" style="margin:8px 0 0">ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h1>
    <p id="docSub" contenteditable="true" class="small" style="margin:6px 0 0">Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©</p>
    <div class="actions">
      <button id="btnPreview">Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
      <button id="btnWord">ØªØµØ¯ÙŠØ± Word</button>
      <label class="btn ghost">
        ÙØªØ­ Ø¨ÙŠØ§Ù†Ø§Øª JSON
        <input id="openJson" type="file" accept="application/json" style="display:none">
      </label>
      <a id="btnSave" class="btn" href="#" download="report.json">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</a>
    </div>
  </div>
</header>

<main class="container no-print">
  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© -->
  <section class="card">
    <h2 contenteditable="true" id="titleBasic">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
    <div class="grid">
      <label>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…<input id="eduDir" placeholder="ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©"></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<input id="school" placeholder="Ù…ØªÙˆØ³Ø·Ø©/Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© ..."></label>
      <label>Ø§Ù„Ù‚Ø³Ù…<input id="dept" placeholder="Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ / Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ ..."></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ù€Ø©<input id="teacher" placeholder="..."></label>
      <label>Ø§Ù„ØªØ®ØµØµ<input id="major" placeholder="..."></label>
      <label>Ø§Ù„ØµÙ<input id="class" placeholder="Ø§Ù„Ø«Ø§Ù†ÙŠ"></label>
      <label>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ<input id="term" placeholder="Ø§Ù„Ø£ÙˆÙ„"></label>
      <label>Ø§Ù„ÙŠÙˆÙ…<input id="day" placeholder="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡"></label>
      <label>Ø§Ù„ØªØ§Ø±ÙŠØ®<input id="date_g" type="date"></label>
      <label>Ø§Ù„Ø­ØµØ©<input id="period" placeholder="Ø§Ù„Ø«Ø§Ù†ÙŠØ©"></label>
      <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬<input id="program" placeholder="..."></label>
      <label>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°<input id="place" placeholder="ØºØ±ÙØ© Ù…ØµØ§Ø¯Ø± Ø§Ù„ØªØ¹Ù„Ù…"></label>
      <label>Ø§Ù„Ø­Ø¶ÙˆØ±<input id="attendance" placeholder="34"></label>
      <label>Ø§Ù„ØºÙŠØ§Ø¨<input id="absence" placeholder="1"></label>
      <label>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©<input id="audience" placeholder="Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ ..."></label>
      <label>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„/Ù€Ø©<input id="owner" placeholder="..."></label>
    </div>
  </section>

  <!-- Ø§Ù„Ø£Ù‡Ø¯Ø§Ù -->
  <section class="card sec-goals">
    <h2 id="titleGoals" contenteditable="true">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <textarea id="goals" rows="3" placeholder="- ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨Ø©
- ØªØ¹Ø²ÙŠØ² Ø§Ù„ØªØ¹Ø§ÙˆÙ† ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§Ù…"></textarea>
  </section>

  <!-- Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ -->
  <section class="card sec-outcomes">
    <h2 id="titleOutcomes" contenteditable="true">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <textarea id="outcomes" rows="3" placeholder="- ØªÙ†Ù…ÙŠØ© Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ
- ØºØ±Ø³ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ø·Ø§Ø¡ ÙˆØªÙ†Ù…ÙŠØ© Ø±ÙˆØ­ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©"></textarea>
  </section>

  <!-- Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ -->
  <section class="card sec-evidence">
    <h2 id="titleEvidence" contenteditable="true">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</h2>
    <div class="small">Ø£Ø¶Ù ØµÙˆØ±Ù‹Ø§ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ (ÙŠÙÙØ¶Ù‘Ù„ Ø£ÙÙ‚ÙŠØ©) Ø£Ùˆ Ø±ÙˆØ§Ø¨Ø· Ø´ÙˆØ§Ù‡Ø¯.</div>
    <div class="actions" style="gap:10px">
      <label class="btn ghost">Ø±ÙØ¹ ØµÙˆØ±<input id="evImages" type="file" accept="image/*" multiple style="display:none"></label>
      <div class="flex" style="flex:1">
        <input id="evLink" type="text" placeholder="https:// Ø±Ø§Ø¨Ø· Ø´Ø§Ù‡Ø¯">
        <button id="addLink" class="btn">Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·</button>
      </div>
    </div>
    <div id="evGrid" class="evd-grid" style="margin-top:10px"></div>
  </section>

  <!-- Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª -->
  <section class="card sec-sign">
    <h2 id="titleSign" contenteditable="true">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</h2>
    <div class="grid">
      <label>Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<input id="signPrincipal" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠØ±/Ø©"></label>
      <label>Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·<input id="signLeader" placeholder="Ø§Ø³Ù… Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·"></label>
    </div>
  </section>
</main>

<!-- PRINT -->
<section id="printArea" class="print-area">
  <div class="report">
    <div class="r-head">
      <div class="r-logos"><div>ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div><div>Ø±Ø¤ÙŠØ© 2030</div></div>
      <h1 id="pDocTitle">ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†ÙØ³ ÙˆØ§Ù„Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h1>
      <p class="meta"><span id="pEduDir"></span> â€” <span id="pSchool"></span> â€” <span id="pDept"></span></p>
      <div class="meta" id="pSub">Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©</div>
    </div>

    <table class="info-table">
      <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…/Ù€Ø©</th><td id="pTeacher"></td><th>Ø§Ù„ØªØ®ØµØµ</th><td id="pMajor"></td></tr>
      <tr><th>Ø§Ù„ØµÙ</th><td id="pClass"></td><th>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</th><td id="pTerm"></td></tr>
      <tr><th>Ø§Ù„ÙŠÙˆÙ…</th><td id="pDay"></td><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><td id="pDateG"></td></tr>
      <tr><th>Ø§Ù„Ø­ØµØ©</th><td id="pPeriod"></td><th>Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°</th><td id="pPlace"></td></tr>
      <tr><th>Ø§Ù„Ø­Ø¶ÙˆØ±</th><td id="pAttendance"></td><th>Ø§Ù„ØºÙŠØ§Ø¨</th><td id="pAbsence"></td></tr>
      <tr><th>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</th><td id="pAudience"></td><th>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„/Ù€Ø©</th><td id="pOwner"></td></tr>
      <tr><th>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th><td id="pProgram" colspan="3"></td></tr>
    </table>

    <h2 id="pTitleGoals">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <div id="pGoals" class="para"></div>

    <h2 id="pTitleOutcomes">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
    <div id="pOutcomes" class="para"></div>

    <h2 id="pTitleEvidence">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</h2>
    <ul id="pEvidence" class="evidence-grid"></ul>

    <h2 id="pTitleSign">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</h2>
    <table class="sign-table">
      <tr><th>Ù…Ø¯ÙŠØ±/Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th><td id="pSignPrincipal"></td></tr>
      <tr><th>Ø±Ø§Ø¦Ø¯/Ø© Ø§Ù„Ù†Ø´Ø§Ø·</th><td id="pSignLeader"></td></tr>
    </table>

    <div class="footer-line">
      <div>Ø£ÙØ¹Ø¯ Ø¨ÙˆØ§Ø³Ø·Ø©: <span id="pOwner2"></span></div>
      <div>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: <span id="pPrintDate"></span></div>
    </div>
  </div>
</section>

<script>
(function(){
  const $ = id => document.getElementById(id);
  const fields = [
    "eduDir","school","dept","teacher","major","class","term","day","date_g",
    "period","program","place","attendance","absence","audience","owner",
    "signPrincipal","signLeader"
  ];
  const evidence = []; // {type:'img'|'link', url, caption}

  // Prefill today
  (function(){ const d = new Date(); $("date_g").value = d.toISOString().slice(0,10); })();

  // Evidence: images
  $("evImages").addEventListener("change", e=>{
    const files = Array.from(e.target.files || []);
    files.forEach(file=>{
      const reader = new FileReader();
      reader.onload = () => {
        evidence.push({type:"img", url: reader.result, caption: ""});
        renderEv();
      };
      reader.readAsDataURL(file);
    });
    e.target.value = "";
  });

  // Evidence: links
  $("addLink").onclick = ()=>{
    const v = $("evLink").value.trim();
    if(!v) return;
    evidence.push({type:"link", url: v, caption: ""});
    $("evLink").value = "";
    renderEv();
  };

  function renderEv(){
    const g = $("evGrid"); g.innerHTML = "";
    evidence.forEach((ev, i)=>{
      const card = document.createElement("div");
      card.className = "evd-item";
      if(ev.type==="img"){
        const img = document.createElement("img"); img.src = ev.url; card.appendChild(img);
      }
      const cap = document.createElement("div"); cap.className = "cap";
      cap.contentEditable = true; cap.spellcheck = false;
      cap.textContent = ev.caption || (ev.type==="link" ? ev.url : "Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„Ø´Ø§Ù‡Ø¯...");
      cap.oninput = ()=> ev.caption = cap.textContent;
      card.appendChild(cap);
      if(ev.type==="link" && !card.querySelector("img")){
        const p = document.createElement("div"); p.style.padding="8px"; p.style.fontSize=".9rem";
        p.innerHTML = `<a href="${ev.url}" target="_blank">${ev.url}</a>`;
        card.insertBefore(p, cap);
      }
      g.appendChild(card);
    });
  }

  // Save JSON
  $("btnSave").onclick = (e)=>{
    const data = {};
    fields.forEach(f=> data[f] = $(f).value || "");
    data.headings = {
      docTitle: $("docTitle").textContent,
      docSub: $("docSub").textContent,
      goals: $("titleGoals").textContent,
      outcomes: $("titleOutcomes").textContent,
      evidence: $("titleEvidence").textContent,
      sign: $("titleSign").textContent
    };
    data.evidence = evidence;
    const blob = new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
    const url = URL.createObjectURL(blob);
    e.currentTarget.href = url;
    e.currentTarget.download = "report.json";
    setTimeout(()=>URL.revokeObjectURL(url), 4000);
  };

  // Open JSON
  $("openJson").addEventListener("change", (ev)=>{
    const file = ev.target.files[0]; if(!file) return;
    const reader = new FileReader();
    reader.onload = ()=>{
      try{
        const data = JSON.parse(reader.result);
        fields.forEach(f=> { if(data[f]!==undefined) $(f).value = data[f]; });
        if(data.headings){
          $("docTitle").textContent = data.headings.docTitle || $("docTitle").textContent;
          $("docSub").textContent = data.headings.docSub || $("docSub").textContent;
          $("titleGoals").textContent = data.headings.goals || $("titleGoals").textContent;
          $("titleOutcomes").textContent = data.headings.outcomes || $("titleOutcomes").textContent;
          $("titleEvidence").textContent = data.headings.evidence || $("titleEvidence").textContent;
          $("titleSign").textContent = data.headings.sign || $("titleSign").textContent;
        }
        (data.evidence||[]).forEach(ev=> evidence.push(ev));
        renderEv();
      }catch(err){ alert("Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­"); }
    };
    reader.readAsText(file);
  });

  function nl2ul(text){
    const items = (text||"").split(/\n+/).map(t=>t.trim()).filter(Boolean);
    if(items.length<=1) return text;
    return items.map(t=> t.replace(/^[-â€¢]\s*/,"")).map(t=>"â€¢ "+t).join("\n");
  }

  function fillPrint(){
    const get = id => $(id).value || "";
    const set = (id,val)=>{ const el=$(id); if(el) el.textContent = val||""; };

    set("pDocTitle", $("docTitle").textContent);
    set("pSub", $("docSub").textContent);
    set("pEduDir", get("eduDir")); set("pSchool", get("school")); set("pDept", get("dept"));
    set("pTeacher", get("teacher")); set("pMajor", get("major"));
    set("pClass", get("class")); set("pTerm", get("term"));
    set("pDay", get("day")); set("pDateG", get("date_g"));
    set("pPeriod", get("period")); set("pPlace", get("place"));
    set("pAttendance", get("attendance")); set("pAbsence", get("absence"));
    set("pAudience", get("audience")); set("pOwner", get("owner")); set("pOwner2", get("owner"));
    set("pProgram", get("program"));

    set("pTitleGoals", $("titleGoals").textContent);
    set("pTitleOutcomes", $("titleOutcomes").textContent);
    set("pTitleEvidence", $("titleEvidence").textContent);
    set("pTitleSign", $("titleSign").textContent);

    set("pGoals", nl2ul(get("goals")));
    set("pOutcomes", nl2ul(get("outcomes")));

    // Evidence to list
    const list = $("pEvidence"); list.innerHTML = "";
    evidence.forEach(ev=>{
      const li = document.createElement("li");
      if(ev.type==="img"){
        const img = document.createElement("img");
        img.src = ev.url; img.style.width="100%"; img.style.display="block";
        li.appendChild(img);
        if(ev.caption){ const c = document.createElement("div"); c.textContent = ev.caption; li.appendChild(c); }
      }else{
        const a = document.createElement("a"); a.href = ev.url; a.target = "_blank"; a.textContent = ev.url;
        li.appendChild(a);
        if(ev.caption){ const c = document.createElement("div"); c.textContent = ev.caption; li.appendChild(c); }
      }
      list.appendChild(li);
    });

    $("pPrintDate").textContent = new Date().toLocaleDateString("ar-SA");
  }

  $("btnPreview").onclick = ()=>{ fillPrint(); window.print(); };
  $("btnWord").onclick = ()=>{
    fillPrint();
    const content = document.querySelector("#printArea").innerHTML;
    const html = `<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="utf-8"></head><body>${content}</body></html>`;
    const blob = new Blob([html], {type: "application/msword"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "ØªÙ‚Ø±ÙŠØ±-Ù†Ø´Ø§Ø·.doc"; a.click();
    setTimeout(()=>URL.revokeObjectURL(url), 4000);
  };
})();
</script>
</body>
</html>
